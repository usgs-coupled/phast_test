% close all
clear all

data = xlsread('arc1.xlsx',5);
% data(:,1) = [];

% momas arc1
sub = WecSubplot('FigurePosition',[100   100   400   700],...
    'RowNo', 2,...
    'ColNo', 1,...
    'TopBorder', 30,...
    'BottomBorder', 50,...
    'RightBorder', 40,...
    'LeftBorder', 70,...
    'VerticalSeparation', 80,...
    'HorizontalSeparation', 10);

axes(sub.AxesHandle{1,1})
box on
plot(...
    log2(data(1:5,2)), log2(data(1:5,11)),'k-o',...
    log2(data(7:11,2)), log2(data(7:11,11)),'k-v',...
    log2(data(13:17,2)), log2(data(13:17,11)),'k-square',...
    'MarkerFaceColor',[0.75 0.75 0.75])
set(gca,'xtick',get(gca,'xtick'),'xticklabel', strtrim(cellstr(num2str((2.^get(gca,'xtick'))'))'))
set(gca,'ytick',get(gca,'ytick'),'yticklabel', strtrim(cellstr(num2str((2.^get(gca,'ytick'))'))'))
axis tight
text(1.05,1,'a)','FontWeight','bold','FontSize',14,'VerticalAlignment','bottom','HorizontalAlignment','left','units','normalized')
xlabel('Number of processes')
ylabel('Normalized computation time')
grid on
set(gca,'Xcolor',[0.5 0.5 0.5],'Ycolor',[0.5 0.5 0.5])
c_axes = copyobj(gca,gcf);
set(c_axes, 'color', 'none', 'xcolor', 'k', 'xgrid', 'off', 'ycolor','k', 'ygrid','off');

axes(sub.AxesHandle{2,1})
box on
plot(...
    log2(data(1:5,2)),log2(data(1:5,2)./data(1,2)),'k-.',...
    log2(data(1:5,2)), log2(data(1:5,13)),'k-o',...
    log2(data(7:11,2)), log2(data(7:11,13)),'k-v',...
    log2(data(13:17,2)), log2(data(13:17,13)),'k-square',...
    'MarkerFaceColor',[0.75 0.75 0.75])
set(gca,'xtick',get(gca,'xtick'),'xticklabel', strtrim(cellstr(num2str((2.^get(gca,'xtick'))'))'))
set(gca,'ytick',0:4, 'yticklabel', strtrim(cellstr(num2str((2.^(0:4))'))'))

axis tight
text(1.05,1,'b)','FontWeight','bold','FontSize',14,'VerticalAlignment','bottom','HorizontalAlignment','left','units','normalized')
xlabel('Number of processes')
ylabel('Relative speedup')
grid on
set(gca,'Xcolor',[0.5 0.5 0.5],'Ycolor',[0.5 0.5 0.5])
c_axes = copyobj(gca,gcf);
set(c_axes, 'color', 'none', 'xcolor', 'k', 'xgrid', 'off', 'ycolor','k', 'ygrid','off');
legend('Ideal','Easy','Medium','Hard',...
    'location','northwest');

print -dmeta Timing_arc1.emf

% lobo2
sub = WecSubplot('FigurePosition',[100   100   400   700],...
    'RowNo', 2,...
    'ColNo', 1,...
    'TopBorder', 30,...
    'BottomBorder', 50,...
    'RightBorder', 40,...
    'LeftBorder', 70,...
    'VerticalSeparation', 80,...
    'HorizontalSeparation', 10);

axes(sub.AxesHandle{1,1})
box on
plot(...
    log2([24 1]),log2([data(25,11)./24 data(25,11)]),'k-.',...
    log2(data(25:31,2)), log2(data(25:31,11)),'k-o',...
    log2(data(35:41,2)), log2(data(35:41,11)),'k-v',...
    'MarkerFaceColor',[0.75 0.75 0.75])
set(gca,'xtick',get(gca,'xtick'),'xticklabel', strtrim(cellstr(num2str((2.^get(gca,'xtick'))'))'))
set(gca,'ytick',get(gca,'ytick'),'yticklabel', strtrim(cellstr(num2str((2.^get(gca,'ytick'))'))'))
axis tight
text(1.05,1,'a)','FontWeight','bold','FontSize',14,'VerticalAlignment','bottom','HorizontalAlignment','left','units','normalized')
xlabel('Number of processes or threads')
ylabel('Computation time (h)')
grid on
set(gca,'Xcolor',[0.5 0.5 0.5],'Ycolor',[0.5 0.5 0.5])
c_axes = copyobj(gca,gcf);
set(c_axes, 'color', 'none', 'xcolor', 'k', 'xgrid', 'off', 'ycolor','k', 'ygrid','off');
legend('Ideal','Multithreaded','Multiprocesses',...
    'location','northeast');

axes(sub.AxesHandle{2,1})
box on
plot(...
    log2(data(25:31,2)),log2(data(25:31,2)./data(25,2)),'k-.',...
    log2(data(25:31,2)), log2(data(25:31,13)),'k-o',...
    log2(data(35:41,2)), log2(data(35:41,13)),'k-v',...
    'MarkerFaceColor',[0.75 0.75 0.75])
set(gca,'xtick',get(gca,'xtick'),'xticklabel', strtrim(cellstr(num2str((2.^get(gca,'xtick'))'))'))
set(gca,'ytick',get(gca,'ytick'),'yticklabel', strtrim(cellstr(num2str((2.^get(gca,'ytick'))'))'))

axis tight
text(1.05,1,'b)','FontWeight','bold','FontSize',14,'VerticalAlignment','bottom','HorizontalAlignment','left','units','normalized')
xlabel('Number of processes or threads')
ylabel('Relative speedup')
grid on
set(gca,'Xcolor',[0.5 0.5 0.5],'Ycolor',[0.5 0.5 0.5])
c_axes = copyobj(gca,gcf);
set(c_axes, 'color', 'none', 'xcolor', 'k', 'xgrid', 'off', 'ycolor','k', 'ygrid','off');

print -dmeta Timing_lobo2.emf